# æ•°å­¦çº¦æ•°/æ¬§æ‹‰å‡½æ•°

#### ä»»ä½•ä¸€ä¸ªæ•´æ•°éƒ½å¯ä»¥åˆ†è§£ä¸ºè´¨å› æ•°,æ ¹æ®`æ•°å­¦è´¨æ•°`æ–‡æ¡£ä¸­çš„çŸ¥è¯†,æˆ‘ä»¬å¯ä»¥ä»¥ä¸‹æ–¹æ³•æ±‚å‡ºæ•°çš„è´¨å› æ•°åˆ†è§£

```cpp
int n;cin>>n;
for(int i = 2; i <= n/i; i ++)
    if(n % i == 0)
    {
        int b = 0;
         while(n % i == 0)n /= i,b++;  
        cout << i << ' ' << b << endl;
    }
if(n > 1)cout << n << ' ' << 1;//ç‰¹åˆ¤ä¸€ä¸‹,å¯èƒ½æœ€åçš„nå°±æ˜¯æœ€å¤§çš„é‚£ä¸ªè´¨å› æ•°

```

#### ç°åœ¨å°è¯•ä¸€ä¸‹æ±‚çº¦æ•°

```cpp
vector<int> find(int n)
{
    vector<int>res;
    for(int i = 1; i <= n / i; i ++)
    {
        if( n % i == 0)
        {
            res.push_back(i);
            if(n/i != i)res.push_back(n/i);
        }
    }
    return res;
}

int main()
{
    int t;cin>>t;
    while(t --)
    {
        int n;cin>>n;
        vector<int>res = find(n);
        sort(res.begin(), res.end());
        for(auto s : res)
        cout << s << ' ';
        cout <<endl; 
    }
}
```

#### ä»ä¸Šé¢ä»£ç ä¸­,åªè¦ä¸€ä¸ªæ•°æ˜¯nçš„çº¦æ•°,å°±å¯ä»¥pushå¦ä¸€ä¸ªçº¦æ•°åˆ°æ•°å€¼ä¸­

#### ç»™å®šnä¸ªæ•°,æ±‚è¿™äº›æ•°ä¹˜ç§¯çš„çº¦æ•°,ä¾‹å¦‚è¾“å…¥ `4 5 2`,å°±æ˜¯è¦æ±‚4\*5\*2çš„çº¦æ•°

#### é¦–å…ˆæ¯ä¸ªçº¦æ•°éƒ½å¯ä»¥è¢«åˆ†è§£ä¸ºåŸæ•°çš„è´¨å› æ•°ä¹˜ç§¯

#### ä¾‹å¦‚,æ±‚12æœ‰å¤šå°‘ä¸ªçº¦æ•°?æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ±‚: 12 å¯ä»¥åˆ†è§£ä¸ºï¼š2^2*3^1ã€‚æ‰€ä»¥2å¯ä»¥å– 0 ~ 2ä¸ªï¼Œ3ç§å–æ³•ã€‚3å¯ä»¥å– 0~1 ä¸ªï¼Œ2ç§å–æ³•ã€‚12çš„çº¦æ•°ä¸€å…±ï¼š2 * 3 = 6ä¸ª. äº†è§£è¿™ç§æ–¹æ³•æ±‚ä¸€ä¸ªæ•°çš„çº¦æ•°,æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªå…¬å¼: N = (p1^x1)(p^x2)(p3^x3)â€¦(pk^xk)ï¼Œå…¶ä¸­piä¸ºè´¨æ•°ã€‚åˆ™Nçš„çº¦æ•°ä¸ªæ•°ä¸ºï¼š(x1+1)(x2+1)(x3+1)â€¦(xk+1)

#### ä½†æ˜¯é¢˜ç›®è¦æ±‚çš„æ˜¯nä¸ªæ•°çš„ä¹˜ç§¯æ±‚çº¦æ•°,å¦‚ä½•è§£å†³? äº‹å®ä¸Š,å…¶å®å°±æ˜¯å¯¹æ¯ä¸ªæ•°åˆ†åˆ«è¿›è¡Œè¿™æ ·çš„æ“ä½œ,ä¸‹é¢çš„å…¬å¼å¯ä»¥çœ‹åˆ°,å…¬å¼æœ¬èº«å¹¶ä¸å…³å¿ƒåº•æ•°,åªå’ŒæŒ‡æ•°æœ‰å…³.

```cpp
#include <iostream>
#include <unordered_map>
using namespace std;
const int N = 1e9+7;//mod N æ˜¯é¢˜ç›®è¦æ±‚
int main()
{
    int n;cin>>n;
    unordered_map<int,int>primes;
    while(n --)
    {
        int x;cin>>x;
        for(int i = 2; i <= x/i; i ++)
            while(x%i == 0)
            {
                x /= i;
                primes[i]++;
            }
        if(x > 1)primes[x]++;
    }
    long long res = 1;
    for(auto p : primes)
        res = res*(p.second+1) % N;
    cout << res;
}
```

#### æˆ‘ä»¬åˆ†è§£å®Œæ¯ä¸ªæ•°,å†ç›¸ä¹˜,ä¸å°±ç›¸å½“äºå¯¹åŸæ•°åˆ†è§£å—?è¿™é‡Œç›¸ä¹˜å°±å˜æˆç›¸åº”æŒ‡æ•°ç›¸åŠ `primes[i]++`,æœ€åå¥—å…¬å¼è§£å†³äº†è¿™é“é¢˜

#### å¦‚æœé¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚çº¦æ•°ä¹‹å’Œå‘¢?çº¦æ•°çš„ä¸ªæ•°ä¸åŒ…å«çº¦æ•°å…·ä½“çš„ä¿¡æ¯å•Š,å¥½åƒæ²¡åŠæ³•ä»ä¸Šé¢è·å¾—è§£å†³æ‰‹æ®µ

### è¿™é‡Œå…ˆç»™å‡ºä»¥ä¸Šå’Œæ­¤é¢˜æ‰€æœ‰å…¬å¼: 

$$
N = p_1^{c1} * p_2^{c2} * â€¦ *p_k^{ck} % åˆ†è§£ä¸€ä¸ªæ•°
\\
çº¦æ•°ä¸ªæ•° =  (c_1 + 1) * (c_2 + 1) * â€¦ * (c_k + 1)
\\
çº¦æ•°ä¹‹å’Œ = (p_1^0 + p_1^1 + â€¦ + p_1^{c1}) * â€¦ * (p_k^0 + p_k^1 + â€¦ + p_k^{ck})
\\
$$



#### æŠŠå¼å­å±•å¼€,æˆ‘ä»¬å°±å¯ä»¥å‘ç°,å®é™…ä¸Šå°±æ˜¯ä¸åŒè´¨å› æ•°çš„æ’åˆ—ç»„åˆå†ç›¸åŠ ,è¿™ä¸æ­£å¥½å°±æ˜¯çº¦æ•°ä¹‹å’Œå—

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e9+7;//é¢˜ç›®è¦æ±‚
int main()
{
    int n;cin>>n;
    unordered_map<int,int>primes;
    while(n --)
    {
        int x;cin>>x;
        for(int i = 2; i <= x/i; i ++)
            while(x % i == 0)
            {
                x /= i;
                primes[i]++;
            }
        if(x > 1)primes[x]++;
    }
    long long res = 1;
    for(auto p : primes)
    {
        int a = p.first, b = p.second;
        long long t = 1;
        while(b --)t = (t*a + 1) % N;
        res = res * t % N;
    }
    cout << res;
}
```

#### æ–°å®šä¹‰: Ï•(N)æ¬§æ‹‰å‡½æ•°,æ„æ€æ˜¯1-Nä¸­ä¸Näº’è´¨çš„æ•°çš„ä¸ªæ•°

#### **äº’è´¨**:è‹¥Nä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°æ˜¯1ï¼Œåˆ™ç§°è¿™Nä¸ªæ•´æ•°äº’è´¨ã€‚

#### ç»™å®šä¸€ä¸ªæ•°n,æ±‚è¿™ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°Ï•(n)

#### [è¶…ç»å¤§ä½¬è§£é‡Š](https://www.acwing.com/solution/content/8702/):

$$
Ï†(n)=Ï†(p_1^{a1})âˆ—â€¦âˆ—Ï†(p_x^{ax})
\\
=(ğ‘_1^{ğ‘1}âˆ’ğ‘_1^{ğ‘1âˆ’1})âˆ—â€¦âˆ—(ğ‘_ğ‘¥^{ğ‘ğ‘¥}âˆ’ğ‘_ğ‘¥^{ğ‘ğ‘¥âˆ’1})
\\
=ğ‘_1^{ğ‘1}âˆ—(1âˆ’\frac{1}{ğ‘1})âˆ—ğ‘_2^{ğ‘2}âˆ—(1âˆ’\frac{1}{ğ‘2})âˆ—â€¦âˆ—ğ‘_ğ‘¥^{ğ‘ğ‘¥}âˆ—(1âˆ’\frac{1}{ğ‘ğ‘¥})
\\
=p_1^{a1}âˆ—p_2^{a2}âˆ—â€¦âˆ—p_x^{ax}âˆ—(1âˆ’\frac{1}{p1})âˆ—(1âˆ’\frac{1}{p2})âˆ—â€¦âˆ—(1âˆ’\frac{1}{px})
\\
=nâˆ—\prod_{i=1}^{x}(1âˆ’\frac{1}{p_i})
$$

#### æ¶‰åŠå®¹æ–¥å®šç†,yxcçš„è§£é‡Šä¹Ÿç®€å•æ˜“æ‡‚,å…·ä½“è¯·å›é¡¾è¯¾ç¨‹,ä¸‹é¢ç»™å‡ºé¢˜è§£ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;

int main()
{
    int n;cin>>n;
    while(n --)
    {
        int x;cin>>x;
        long long res = x;
        for(int i = 2; i <= x/i; i ++)
            if(x%i == 0)
            {
                res -= res/i;
                while(x % i == 0)x /= i;
            }
        if(x > 1)res = res*(x-1)/x;// (1-1/pi)å¯èƒ½æœ‰åå·®?,è¿™é‡Œç”¨çš„æ˜¯(res-res/pi)=(pi*res-res)/pi=(res*(pi-1))/pi;
        cout << res << endl;
    }
    
}
```

~~(æ²¡é”™æˆ‘ä¹Ÿå¾ˆéœ‡æƒŠå±…ç„¶è¿™ä¹ˆçŸ­)~~



### ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°:ç»™å®šä¸€ä¸ªæ•°n,æ±‚1-næ¯ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°

#### åœ¨ä¹‹å‰è´¨æ•°ç« èŠ‚ä¸­,æœ‰ä¸€ä¸ªæ–¹æ³•èƒ½å¿«é€Ÿæ±‚1-næ‰€æœ‰è´¨æ•°,å°±æ˜¯çº¿æ€§ç­›æ³•,å…ˆå›é¡¾ä¸€ä¸‹

```cpp
const int N = 1000010;
int primes[N],cnt,phi[N];//è¿™é‡Œå®šä¹‰äº†phiæ¥è®°å½•æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°
bool st[N];
long long get_eulers(int n)
{
    //çº¿ç­›
    for(int i = 2; i <= n; i ++)
    {
        if(!st[i])primes[cnt++] = i;
        for(int j = 0; primes[j] <= n/i; j ++)
        {
            st[primes[j]*i] = true;
            if(i % primes[j] == 0)break;
		}
	}
}

int main()
{
    int n;cin>>n;
    return 0;
}
```

#### è¿™é‡Œç»™å‡ºäº†çº¿ç­›çš„æ¨¡æ¿,æˆ‘ä»¬è¦æ±‚çš„æ¬§æ‹‰å‡½æ•°ä¸å°±æ˜¯ä¸€ä¸ªæ•°å®ƒæœ¬èº«å†ä¹˜ä»¥(1-å®ƒæ‰€æœ‰çš„è´¨å› æ•°çš„å€’æ•°)å—

$$
n*\prod_{i=1}^n(1-\frac{1}{p_i})
$$



#### çº¿ç­›å¼•é¢†æˆ‘ä»¬çŸ¥é“äº†1-næ‰€æœ‰è´¨å› æ•°,é‚£ä¹ˆä¹Ÿä¸è´Ÿçº¿ç­›æœŸæœ›,åˆ©ç”¨è¿™äº›è´¨æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜

#### é¦–å…ˆ,åœ¨çº¿ç­›æ¨¡æ¿ä¸­æœ‰ä¸‰ç§æƒ…å†µ: 

1.  #### è¿™ä¸ªæ•°æ˜¯è´¨æ•°

2. #### è¿™ä¸ªæ•°modä¸Šprimes[j]ç­‰äº0

3. #### è¿™ä¸ªæ•°modä¸Šprimes[j]ä¸ç­‰äº0

#### æˆ‘ä»¬ä»¥æ­¤é™¤äº†è¿™äº›æƒ…å†µ,æ‰€å¾—çš„phiæ•°ç»„å°±æ˜¯æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°

#### é¦–å…ˆçœ‹ç¬¬ä¸€ç§æƒ…å†µ: è¿™ä¸ªæ•°æ˜¯è´¨æ•°,è´¨æ•°çš„æ¬§æ‹‰å‡½æ•°æ˜¯ä»€ä¹ˆ?æ ¹æ®æ¬§æ‹‰å‡½æ•°çš„å®šä¹‰:1-nä¸näº’è´¨çš„æ•°çš„ä¸ªæ•°,å¾ˆæ˜æ˜¾,å®ƒä¸1åˆ°(n-1)éƒ½äº’è´¨,æ‰€ä»¥å®ƒçš„æ¬§æ‹‰å‡½æ•°æ˜¯n-1

#### å†æ¥çœ‹ç¬¬äºŒç§æƒ…å†µ: è¿™ä¸ªæ•°modä¸Šprimes[j]ç­‰äº0,æ„æ€å°±æ˜¯primes[j]æ˜¯è¿™ä¸ªæ•°çš„è´¨å› æ•°,é‚£ä¹ˆ`primes[j]*i`è¿™ä¸ªæ•°ä¸­æ‰€æœ‰çš„è´¨å› æ•°æ²¡æœ‰å˜,åªæ˜¯å¤šä¹˜ä»¥äº†ä¸ªprimes[j],æ¬§æ‹‰å‡½æ•°å…¬å¼é‡Œå¯å’Œè´¨å› æ•°çš„æŒ‡æ•°æ— å…³,æ‰€ä»¥`primes[j]*i`çš„æ¬§æ‹‰å‡½æ•°ç­‰äºiçš„æ¬§æ‹‰å‡½æ•°ä¹˜ä»¥primes[j]\(ä¹Ÿå°±æ˜¯è¯´,å…¬å¼é‡Œçš„næ˜¯`primes[j]*i`,è´¨å› æ•°çš„ç§ç±»æ²¡æœ‰å˜\)

#### æœ€åä¸€ç§æƒ…å†µ: è¿™ä¸ªæ•°modä¸Šprimes[j]ä¸ç­‰äº0,ä¹Ÿå°±æ˜¯è¯´,primes[j]æ˜¯i\*primes[j]çš„è´¨å› æ•°,å…·ä½“æ¥è¯´,å°±æ˜¯`i*primes[j])`è¿™ä¸ªæ•°,é™¤äº†`i`çš„æ¬§æ‹‰å‡½æ•°å¤–,è¿˜æœ‰ä¸€ä¸ªprimes[j]è¿™ä¸ªè´¨å› æ•°,é‚£ä¹ˆ`i`çš„æ¬§æ‹‰å‡½æ•°ä¹˜ä¸Šprimes[j]ä»¥åŠè¿™ä¸ªå¤šå‡ºæ¥çš„`1-è´¨å› æ•°çš„å€’æ•°`,å°±æ˜¯`i*primes[j]`è¿™ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°,

#### æŠŠæ¯ç§æƒ…å†µå†™å…¥çº¿ç­›çš„ä»£ç ,å°±å®Œæˆäº†1-næ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°æ±‚è§£,ä»¥ä¸‹æ˜¯yæ€»ä»£ç 

```cpp
#include <iostream>
using namespace std;
typedef long long LL;
const int N = 1000010;
int primes[N], cnt;
int euler[N];
bool st[N];
void get_eulers(int n)
{
    euler[1] = 1;
    for (int i = 2; i <= n; i ++ )
    {
        if (!st[i])
        {
            primes[cnt ++ ] = i; //æƒ…å†µ1
            euler[i] = i - 1;
        }
        for (int j = 0; primes[j] <= n / i; j ++ )
        {
            int t = primes[j] * i;
            st[t] = true;
            if (i % primes[j] == 0)//æƒ…å†µ2
            {
                euler[t] = euler[i] * primes[j];
                break;
            }
            euler[t] = euler[i] * (primes[j] - 1);//æƒ…å†µ3
        }
    }
}

int main()
{
    int n;
    cin >> n;
    get_eulers(n);
    LL res = 0;
    for (int i = 1; i <= n; i ++ ) res += euler[i];
    cout << res << endl;
    return 0;
}

```

