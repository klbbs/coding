# 广东工业大学 K-橘猫的后缀问题

**[官方题解](https://ac.nowcoder.com/discuss/1481277)**

#### 题目描述

![](C:\Users\kendas\Desktop\for_code_skill\基础算法\photos\广东K.png)

![广东K2](C:\Users\kendas\Desktop\for_code_skill\基础算法\photos\广东K2.png)

#### 分析来源官方题解及AI,仅整理:

#### 题目加粗的部分谈到`初始字符串和修改操作中的字符是从 1<=x<=n,{a,b,…,z}中均匀随机抽取的`

#### 假设只比较每个后缀字符串前L个字符,那么比较出现相同的概率为$\frac{n}{26^L}$(总共是n个后缀字符串,每个字符串前L位可能性有$26^L$)

#### 也就是说我们完全可以用暴力的方法,要比较两个字符串字典序大小,直接按位比较就完事了.

#### 但是要确定一个字符串的排名,就需要对所有的字符串进行排序,怎么排序呢?如果没有统一的比较标准,即不方便存储,也不方便逻辑书写.我们假设每个字符串都只比较前2个(自定),那么要排序,我们可以来个27进制(最后一个后缀字符串只有一个字符,需要0来补充),这样我们统计完就可以进行排序了,但是这并不是十全十美的,如果发生冲突了,即两个后缀字符串的前两个字符相等,那就需要根据实际情况再往后面比较,但是我们说了,这种情况很少(Q是随机的).

#### 当我们修改一个字符,那么我们实际只修改了2个字符串(L=2),即$S_xS_{x+1}\dots S_n$和$S_{x-1}S_x\dots S_n$这两个字符串,要消去原来的权值影响,再添加上新的,我们可以采用树状数组来写,在原来的权值那减去,再算出新的权值后加上.根据原字符串我们很轻松就能知道要修改的字符.

#### 现在假设发生了1个冲突,那么我们怎么知道那个冲突在字符串的什么位置呢?(因为我们需要比较当前字符和冲突字符)我们需要再维护一个二维数组,统计每个权值所对应的下标,这样清楚了冲突字符串位置.

#### 代码请看[官方题解](https://ac.nowcoder.com/discuss/1481277)









